@model IEnumerable<SuggestionSystem.Models.SuggestProfilVm>
@{
    ViewBag.Title = "Details";
    //var Sugg = (IEnumerable<SuggestionSystem.Models.SuggProfile_SuggType_Interface>)ViewBag.SuggProfile_SuggType_Interface;
    var PProfile = (SuggestionSystem.Models.PersonProfile)ViewBag.PersonProfile;
}
<div class="form-horizontal container">
    <div class="panel panel-primary ">
        <div class="panel-body">
            <div class="alert alert-info">
                <div style="text-align:left">
                    @if (User.Identity.IsAuthenticated)
                    {
                        <a class="btn btn-warning" onclick="location.href='@Url.Action("Index", "SuggestProfils",null)';return false;">   بازگشت به لیست  <i class="fa fa-backward"></i></a>
                    }
                    else
                    {
                    }
                    <a class="btn btn-danger" onclick="location.href='@Url.Action("Search", "PersonProfiles")';return false;">خروج    <i class="glyphicon glyphicon-log-out faa-ring animated"></i></a>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-4 ">نام ونام خانوادگی :&nbsp;<span class="span">@PProfile.FullName</span></div>
                <div class="col-md-4">نام پدر :&nbsp;<span class="span">@PProfile.FatherName</span></div>
                <div class="col-md-4 ">کدملی :&nbsp;<span class="span">@PProfile.NationalCode</span></div>
                <div class="col-md-4 ">مدرک تحصیلی  :&nbsp;<span class="span">@PProfile.Degree.Title</span></div>
                <div class="col-md-4 ">رشته تحصیلی  :&nbsp;<span class="span">@PProfile.Reshte</span></div>
                <div class="col-md-4 ">تاریخ تولد  :&nbsp;<span class="span">@PProfile.BirthDate</span></div>
                <div class="col-md-4 ">نوع شرکت کننده  :&nbsp;<span class="span">@PProfile.MemberType.Title</span></div>
                <div class="col-md-4 ">پست سازمانی   :&nbsp;<span class="span">@PProfile.PostOrgans  </span></div>
                <div class="col-md-4 ">شماره تلفن همراه   :&nbsp;<span class="span">@PProfile.Mobile  </span></div>
                <div class="col-md-4 ">شماره تلفن ثابت   :&nbsp;<span class="span">@PProfile.Phone </span></div>
                <div class="col-md-4 ">آدرس پست الکترونیک   :&nbsp;<span class="span">@PProfile.Email  </span></div>
            </div>
            <div class="row">
                <div class="col-md-4 ">
                    <span class="fa fa-pencil-square-o fa-2x" style="color:#e26d19">   &nbsp;   </span><b>@Html.ActionLink(" ویرایش اطلاعات پایه ", "EditP", "PersonProfiles", new { id = @PProfile.PersonProfileId }, new { @class = "my-class2" })</b>
                </div>
                <div class="col-md-4 ">
                    <a href="@Url.Action("Create", "SuggestProfils", new { id= @PProfile.PersonProfileId,typeId=@PProfile.MemberType.Id})" role="button">
                        <i class="fas fa-plus-square fa-2x" style="color:#2a05a8"></i> <b>
                            ثبت پیشنهاد جدید
                        </b>
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table id="example6" class="table table-bordered table-striped   table-responsive">
                                    <thead>
                                        <tr>
                                            <th># </th>
                                            <th>فایل های پیوست</th>
                                            <th>عنوان پپیشنهاد     </th>
                                            <th>  وضعیت موجود </th>
                                            <th>وضعیت مطلوب      </th>
                                            <th>تاریخ ثبت پیشنهاد      </th>

                                            <th>مزایای روش پیشنهادی       </th>
                                            <th>میزان اعتبار برآورد شده     </th>
                                            <th>    نحوه محاسبه   </th>
                                            <th>    مدت زمان مورد نیاز    </th>
                                            <th>    امکانات و تجهیزات       </th>
                                            <th>    منافع حاصله از پیشنهاد         </th>
                                            <th>ویرایش</th>
                                            <th width="30%">
                                                <table class="table-hover" style="width:100%;">

                                                    <tr>

                                                        <td> دبیر خانه </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            توضیحات
                                                        </td>
                                                        <td>
                                                            وضعیت پیشنهاد
                                                        </td>
                                                    </tr>
                                                </table>
                                            </th>
                                            @*<th colspan="2" width="30%">
                                                <table class="table-hover" style="width:100%;">

                                                    <tr>
                                                        <td> داوران  </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            تاریخ صورتجلسه
                                                        </td>
                                                        <td>
                                                            شماره صورتجلسه
                                                        </td>
                                                        <td>
                                                            توضیحات
                                                        </td>
                                                        <td>
                                                            وضعیت پیشنهاد
                                                        </td>
                                                        <td>
                                                            امتیاز
                                                        </td>
                                                    </tr>
                                                </table>
                                            </th>*@
                                            <th></th>
                                        </tr>

                                    </thead>
                                    <tbody>

                                        @foreach (var item in Model)
                                        {
                                        <tr>
                                            <td></td>
                                            <td>
                                                <a href="@Url.Action("UploadDocNew", "FileUploads",new { id=item.SuggestId,PProfileId=item.PersonProfileId} )" class=" " role="button"><i class="glyphicon glyphicon-picture fa-2x" style="color:#91c77a"></i></a>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.SuggestTitle)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.CurrentSituationNote)
                                            </td>
                                            <td>

                                                @{
                                                    string SuggestNote = item.SuggestNote;
                                                    if (SuggestNote != null)

                                                    {
                                                        if (SuggestNote.Length > 25)
                                                        {
                                                            SuggestNote = SuggestNote.Substring(0, 25);
                                                            @SuggestNote
                                                            <a href="@Url.Action("SuggestNote", "SuggestProfils",new { id=item.SuggestId} )" class="data-modal Mystyle2" role="button">(ادامه ...)</a>

                                                        }
                                                        else
                                                        {
                                                            @SuggestNote
                                                        }
                                                    }

                                                }
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.DateInsert)
                                            </td>

                                            <td>
                                                @Html.DisplayFor(modelItem => item.Result)

                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Cost)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Note_Cost)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.PeriodOfTime)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Equipment)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Benefits)
                                            </td>

                                            <td>
                                                @if (item.S_SuggType_Inter.Count > 0)
                                                {
                                                    <i class="fa fa-pencil-square-o"></i>
                                                }
                                                else
                                                {
                                                    <a href="@Url.Action("SuggestEdit", "SuggestProfils",new { id=item.SuggestId} )" class=" " role="button"><i class="fa fa-pen-square fa-2x" style="color:#91c77a"></i></a>
                                                }
                                            </td>
                                            <td width="30%">
                                                @foreach (var i in item.S_SuggType_Inter)
                                                {
                                                    if (i.ID_Part == 1)
                                                    {
                                                        <table style="background-color:#91c77a;border-color:#91c77a;width:100%" class="table-bordered">
                                                            <tr>

                                                                <td>
                                                                    @i.Note_Secretariate
                                                                </td>
                                                                <td>
                                                                    @i.SuggestType.Title
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <b>
                                                            &nbsp;&nbsp;&nbsp;
                                                        </b>
                                                    }
                                                }
                                            </td>
                                            @*<td>
                                                @foreach (var g in item.S_SuggType_Inter)
                                                {
                                                    if (g.ID_Part == 2)
                                                    {
                                                        <table style="background-color:#f5e384;border-color:#91c77a;width:100%" class="table-bordered">


                                                            <tr>
                                                                <td>
                                                                    @g.SuggestType.Title
                                                                </td>
                                                                <td>
                                                                    @g.Date
                                                                </td>
                                                                <td>
                                                                    @g.LetterNumber
                                                                </td>
                                                                <td>
                                                                    @g.Point
                                                                </td>
                                                            </tr>

                                                        </table>
                                                    }
                                                }
                                            </td>*@
                                            <td></td>
                                        </tr>
                                        }
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th></th>
                                            <th></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id='myModal' class='modal fade in'>
    <div class="modal-dialog">
        <div class="modal-content">
            <div id='myModalContent'></div>
        </div>
    </div>
</div>
@section scripts{
}
<script>
    $(document).ready(function () {
        var t = $('#example6').DataTable({

            'paging': true,
            'lengthChange': true,
            'searching': true,
            'ordering': true,
            'info': true,
            'autoWidth': true,
            "pageLength": 10,
            //"responsive": true,
            "lengthMenu": [5, 10, 25, 50, "All"],
            "language": {
                select: {
                    rows: "%d سطرانتخاب شده "
                },

                "sEmptyTable": "هیچ داده‌ای در جدول وجود ندارد",
                "sInfo": "نمایش _START_ تا _END_ از _TOTAL_ ردیف",
                "sInfoEmpty": "نمایش 0 تا 0 از 0 ردیف",
                "sInfoFiltered": "(فیلتر شده از _MAX_ ردیف)",
                "sInfoPostFix": "",
                "sInfoThousands": ",",
                "sLengthMenu": "نمایش _MENU_ ردیف",
                "sLoadingRecords": "در حال بارگزاری...",
                "sProcessing": "در حال پردازش...",
                "sSearch": "جستجو:",
                "sZeroRecords": "رکوردی با این مشخصات پیدا نشد",

                "oPaginate": {
                    "sFirst": "برگه‌ی نخست",
                    "sLast": "برگه‌ی آخر",
                    "sNext": "بعدی",
                    "sPrevious": "قبلی"
                },
                "oAria": {
                    "sSortAscending": ": فعال سازی نمایش به صورت صعودی",
                    "sSortDescending": ": فعال سازی نمایش به صورت نزولی"
                },

            },
            'stateSave': true,

            dom: 'Bfrtip',
            buttons: [
                'pageLength',
                {

                    extend: 'print',
                    text: 'پرینت',
                    exportOptions: {
                        columns: ':visible'
                    },
                    customize: function (win) {
                        $(win.document.body)
                            .css('font-size', '10pt')
                            .prepend(
                                //'<img src="http://datatables.net/media/images/logo-fade.png" style="position:absolute; top:0; left:0;" />'
                            );

                        $(win.document.body).find('table')
                            .addClass('compact')
                            .css('font-size', 'inherit');
                    }
                }
                ,


                //{
                //    extend: 'colvis',
                //    text: 'تغییر ستونها',

                //    collectionLayout: 'fixed three-column'
                //}
            ],

            columnDefs: [{
                targets: -1,
                visible: false
            }],
            initComplete: function () {
                this.api().columns().every(function () {
                    var column = this;
                    var select = $('<select><option value=""></option></select>')
                        .appendTo($("#filters").find("th").eq(column.index()))
                        .on('change', function () {
                            var val = $.fn.dataTable.util.escapeRegex(
                                $(this).val());

                            column.search(val ? '^' + val + '$' : '', true, false)
                                .draw();
                        });

                    console.log(select);

                    column.data().unique().sort().each(function (d, j) {
                        select.append('<option value="' + d + '">' + d + '</option>')
                    });
                });
            },
            select: true
        }); t.on('order.dt search.dt', function () {
            t.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();
        $('a.toggle-vis').on('click', function (e) {
            e.preventDefault();
            var column = table.column($(this).attr('data-column'));
            column.visible(!column.visible());
        });
    });
    $('.btn-number').click(function (e) {
        e.preventDefault();

        fieldName = $(this).attr('data-field');
        type = $(this).attr('data-type');
        var input = $("input[name='" + fieldName + "']");
        var currentVal = parseInt(input.val());
        if (!isNaN(currentVal)) {
            if (type == 'minus') {

                if (currentVal > input.attr('min')) {
                    input.val(currentVal - 1).change();
                }
                if (parseInt(input.val()) == input.attr('min')) {
                    $(this).attr('disabled', true);
                }

            } else if (type == 'plus') {

                if (currentVal < input.attr('max')) {
                    input.val(currentVal + 1).change();
                }
                if (parseInt(input.val()) == input.attr('max')) {
                    $(this).attr('disabled', true);
                }
            }
        } else {
            input.val(0);
        }
    });
    $('.input-number').focusin(function () {
        $(this).data('oldValue', $(this).val());
    });
    $('.input-number').change(function () {

        minValue = parseInt($(this).attr('min'));
        maxValue = parseInt($(this).attr('max'));
        valueCurrent = parseInt($(this).val());

        name = $(this).attr('name');
        if (valueCurrent >= minValue) {
            $(".btn-number[data-type='minus'][data-field='" + name + "']").removeAttr('disabled')
        } else {
            alert('Sorry, the minimum value was reached');
            $(this).val($(this).data('oldValue'));
        }
        if (valueCurrent <= maxValue) {
            $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
        } else {
            alert('Sorry, the maximum value was reached');
            $(this).val($(this).data('oldValue'));
        }
    });
    $(".input-number").keydown(function (e) {
        if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
            (e.keyCode == 65 && e.ctrlKey === true) ||
            (e.keyCode >= 35 && e.keyCode <= 39)) {
            // let it happen, don't do anything
            return;
        }
        // Ensure that it is a number and stop the keypress
        if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
            e.preventDefault();
        }
    });
    $('input#Cost').keyup(function (event) {
        // skip for arrow keys
        if (event.which >= 37 && event.which <= 40) return;

        // format number
        $(this).val(function (index, value) {
            return value
                .replace(/\D/g, "")
                .replace(/\B(?=(\d{3})+(?!\d))/g, ",")
                ;
        });
    });
</script>